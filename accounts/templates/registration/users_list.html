<!DOCTYPE html> 
<html>
<head>
    <title>Users List</title>
    <style>             
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px; border: 1px solid #ccc; text-align: left; }
        th { background-color: #007bff; color: white; }
        tr:hover { background-color: #f5f5f5; cursor: pointer; }
        .btn { padding: 5px 10px; margin: 5px 2px; text-decoration: none; border-radius: 3px; font-size: 12px; }
        .btn-view { background: #007bff; color: white; }
        .btn-edit { background: #28a745; color: white; }
        .btn-delete { background: #dc3545; color: white; }
        .modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 10% auto; padding: 20px; border: 1px solid #888; width: 50%; border-radius: 5px; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: black; }
        .detail-row { margin: 10px 0; }
        .detail-label { font-weight: bold; color: #333; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Users List</h1>
        <a href="{% url 'profile' %}" class="btn btn-view">Back to Profile</a>
        
        <table>
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Phone</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr onclick="openModal('{{ user.id }}', '{{ user.username }}', '{{ user.email }}', '{{ user.phone_number }}', '{{ user.first_name }}', '{{ user.last_name }}', '{{ user.role }}')">
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                    <td><span style="background: #007bff; color: white; padding: 3px 8px; border-radius: 3px;">{{ user.role|upper }}</span></td>
                    <td>{{ user.phone_number }}</td>
                    <td>
                        <a href="{% url 'admin_edit_user' user.id %}" class="btn btn-edit" onclick="event.stopPropagation();">Edit</a>
                        <a href="{% url 'admin_delete_user' user.id %}" class="btn btn-delete" onclick="event.stopPropagation(); return confirm('Are you sure?')">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Modal for user details -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>User Details</h2>
            <div class="detail-row">
                <span class="detail-label">Username:</span>
                <span id="modalUsername"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Email:</span>
                <span id="modalEmail"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Phone:</span>
                <span id="modalPhone"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">First Name:</span>
                <span id="modalFirstName"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Last Name:</span>
                <span id="modalLastName"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Role:</span>
                <span id="modalRole"></span>
            </div>
            <hr>
            <div>
                <a id="editBtn" class="btn btn-edit">Edit User</a>
                <button onclick="closeModal()" style="padding: 5px 10px; background: #6c757d; color: white; border: none; border-radius: 3px; cursor: pointer;">Close</button>
            </div>
        </div>
    </div>

    <script>
        function openModal(userId, username, email, phone, firstName, lastName, role) {
            document.getElementById('modalUsername').textContent = username;
            document.getElementById('modalEmail').textContent = email;
            document.getElementById('modalPhone').textContent = phone;
            document.getElementById('modalFirstName').textContent = firstName;
            document.getElementById('modalLastName').textContent = lastName;
            document.getElementById('modalRole').textContent = role.toUpperCase();
            document.getElementById('editBtn').href = '/accounts/users/' + userId + '/edit/';
            document.getElementById('userModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('userModal').style.display = 'none';
        }

        window.onclick = function(event) {
            var modal = document.getElementById('userModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>